@using SmartCode
@using SmartCode.Db
@model BuildContext
@{
    Layout = "_SqlMapLayout.cshtml";
    var project = Model.Project;
    var dbSource = Model.GetDataSource<DbSource>();
    var buildTask = Model.Build;
    var table = Model.GetCurrentTable();
    var pkCol = table.PKColumn;
    if (pkCol == null)
    {
        throw new SmartCodeException($"{table.Name} can not find PKColumn！");
    }

    var resultMapName = $"{table.ConvertedName}ResultMap";
}

@section QueryByPage
{
    <select id="queryByPage" resultMap="@resultMapName">
        select * from @table.Name
        <include refid="queryParams"/>
        Limit #{pageSize} Offset #{pageIndex}
    </select>


}


@section GetEntity
{
    <!--获取表映射实体-->
    <select id="getEntity" resultMap="@resultMapName">
        Select *
        From @table.Name
        <include refid="queryParams"/>
        limit 1
    </select>
}

@section Query
{
    <!--获取数据列-->
    <select id="query" resultMap="@resultMapName">
        SELECT *
        From @table.Name T
        <include refid="queryParams"/>
        <if test="taken!=null">
            limit #{taken}
        </if>
    </select>
}